(()=>{addEventListener("fetch",(t=>{t.respondWith(async function(t){const{pathname:i}=new URL(t.url);if(i.startsWith("/favicon"))return fetch(t);const o=function(n){const e={};return n.split(";").forEach((n=>{const[t,i]=n.split("=");t&&i&&(e[t.trim()]=i.trim())})),e}(t.headers.get("Cookie")||"")[n]||crypto.randomUUID(),a=await async function(){const n=await fetch("http://webdis.astroadrenaline.com:7379/dbsize");return(await n.json()).DBSIZE}();return console.log("current capacity:"+a),a<e||await async function(n){const e=await fetch(`http://webdis.astroadrenaline.com:7379/get/${n}`);return"true"===(await e.json()).GET}(o)?async function(){const n=new Response("\n    <title>Waiting Room</title>\n    <meta http-equiv='refresh' content='30' />\n    <style>\n      * {\n        box-sizing: border-box;\n        margin: 0;\n        padding: 0;\n      }\n      body {\n        line-height: 1.4;\n        font-size: 1rem;\n        font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", sans-serif;\n        padding: 2rem;\n        display: grid;\n        place-items: center;\n        min-height: 100vh;\n      }\n      .container {\n        width: 100%;\n        max-width: 800px;\n      }\n      p {\n        margin-top: .5rem;\n      }\n    </style>\n    <div class='container'>\n      <h1>\n        <div>You are now in line.</div>\n        <div>Thanks for your patience.</div>\n      </h1>\n      <p>We are experiencing a high volume of traffic. Please sit tight and we will let you in soon.</p>\n      <p><b>This page will automatically refresh, please do not close your browser.</b></p>\n    </div>\n  ");return n.headers.set("content-type","text/html;charset=UTF-8"),n}():function(){const n=new Response('\n    <title>Waiting Room Demo</title>\n    <style>\n      * {\n        box-sizing: border-box;\n        margin: 0;\n        padding: 0;\n      }\n      body {\n        line-height: 1.4;\n        font-size: 1rem;\n        font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;\n        padding: 2rem;\n        display: grid;\n        place-items: center;\n        min-height: 100vh;\n      }\n      .container {\n        width: 100%;\n        max-width: 800px;\n      }\n      p {\n        margin-top: .5rem;\n      }\n    </style>\n    <div class="container">\n      <h1>\n        <div>Waiting Room Demo</div>\n      </h1>\n      <p>Visit this site from a different browser, you will be forwarded to the waiting room when the capacity is full.</p>\n      <p>Check <a href="https://github.com/upstash/waiting-room" style="color: blue;">this project</a> to set up a waiting room for your website.</p>\n    </div>\n  ');return n.headers.set("content-type","text/html;charset=UTF-8"),n}()}(t.request))}));const n="__waiting_room_id",e=1})();